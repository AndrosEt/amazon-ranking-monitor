(function(e){function t(t){for(var a,n,c=t[0],o=t[1],l=t[2],d=0,u=[];d<c.length;d++)n=c[d],Object.prototype.hasOwnProperty.call(i,n)&&i[n]&&u.push(i[n][0]),i[n]=0;for(a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a]);h&&h(t);while(u.length)u.shift()();return s.push.apply(s,l||[]),r()}function r(){for(var e,t=0;t<s.length;t++){for(var r=s[t],a=!0,n=1;n<r.length;n++){var c=r[n];0!==i[c]&&(a=!1)}a&&(s.splice(t--,1),e=o(o.s=r[0]))}return e}var a={},n={app:0},i={app:0},s=[];function c(e){return o.p+"js/"+({}[e]||e)+"."+{"chunk-25bfe4ba":"ba00eae7","chunk-4a54513f":"3b9f8e17"}[e]+".js"}function o(t){if(a[t])return a[t].exports;var r=a[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.e=function(e){var t=[],r={"chunk-25bfe4ba":1,"chunk-4a54513f":1};n[e]?t.push(n[e]):0!==n[e]&&r[e]&&t.push(n[e]=new Promise((function(t,r){for(var a="css/"+({}[e]||e)+"."+{"chunk-25bfe4ba":"a1133b9d","chunk-4a54513f":"eee0530d"}[e]+".css",i=o.p+a,s=document.getElementsByTagName("link"),c=0;c<s.length;c++){var l=s[c],d=l.getAttribute("data-href")||l.getAttribute("href");if("stylesheet"===l.rel&&(d===a||d===i))return t()}var u=document.getElementsByTagName("style");for(c=0;c<u.length;c++){l=u[c],d=l.getAttribute("data-href");if(d===a||d===i)return t()}var h=document.createElement("link");h.rel="stylesheet",h.type="text/css",h.onload=t,h.onerror=function(t){var a=t&&t.target&&t.target.src||i,s=new Error("Loading CSS chunk "+e+" failed.\n("+a+")");s.code="CSS_CHUNK_LOAD_FAILED",s.request=a,delete n[e],h.parentNode.removeChild(h),r(s)},h.href=i;var p=document.getElementsByTagName("head")[0];p.appendChild(h)})).then((function(){n[e]=0})));var a=i[e];if(0!==a)if(a)t.push(a[2]);else{var s=new Promise((function(t,r){a=i[e]=[t,r]}));t.push(a[2]=s);var l,d=document.createElement("script");d.charset="utf-8",d.timeout=120,o.nc&&d.setAttribute("nonce",o.nc),d.src=c(e);var u=new Error;l=function(t){d.onerror=d.onload=null,clearTimeout(h);var r=i[e];if(0!==r){if(r){var a=t&&("load"===t.type?"missing":t.type),n=t&&t.target&&t.target.src;u.message="Loading chunk "+e+" failed.\n("+a+": "+n+")",u.name="ChunkLoadError",u.type=a,u.request=n,r[1](u)}i[e]=void 0}};var h=setTimeout((function(){l({type:"timeout",target:d})}),12e4);d.onerror=d.onload=l,document.head.appendChild(d)}return Promise.all(t)},o.m=e,o.c=a,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(r,a,function(t){return e[t]}.bind(null,a));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/amazon-ranking-tool/",o.oe=function(e){throw console.error(e),e};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],d=l.push.bind(l);l.push=t,l=l.slice();for(var u=0;u<l.length;u++)t(l[u]);var h=d;s.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"034f":function(e,t,r){"use strict";r("85ec")},1:function(e,t){},10:function(e,t){},11:function(e,t){},12:function(e,t){},13:function(e,t){},14:function(e,t){},15:function(e,t){},2:function(e,t){},3:function(e,t){},"3dfd":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("router-view")],1)},n=[],i=r("2909"),s=r("5530"),c=r("1da1"),o=(r("99af"),r("d81d"),r("a9e3"),r("b680"),r("96cf"),r("e700")),l=r.n(o),d=r("d697"),u={name:"App",components:{},data:function(){return{INIT_OPTIONS:{bulk:!0,number:d["defaultItemLimit"],filetype:"",rating:[1,5],page:1,cookie:"",asyncTasks:10,sponsored:!1,category:"aps",cli:!1,sort:!1,discount:!1,reviewFilter:{sortBy:"recent",verifiedPurchaseOnly:!1,filterByStar:"",formatType:"all_formats"}},dbDataList:[],dbKeyList:[]}},created:function(){},mounted:function(){},methods:{startTask:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$dbOperation.dbOperation("getAll");case 2:return e.dbDataList=t.sent,t.next=5,e.$dbOperation.dbOperation("getAllKeys");case 5:e.dbKeyList=t.sent,e.intervalId=setInterval(e.listLoop,6e4);case 7:case"end":return t.stop()}}),t)})))()},listLoop:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var r,a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(r=0;r<e.dbDataList.length;r++)for(e.dbDataList[r],a=e.dbDataList[r].keywords,n=0;n<a.length;n++)console.log("i: ".concat(r,", j: ").concat(n));case 1:case"end":return t.stop()}}),t)})))()},checkRanking:function(e,t,r){var a=this;return Object(c["a"])(regeneratorRuntime.mark((function n(){var o,u,h,p;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return o=Object(s["a"])({},a.INIT_OPTIONS),o.geo=d["geo"][o.country]?d["geo"][o.country]:d["geo"]["US"],o.scrapeType="ranking",o.asyncPage=5,o.bulk=!0,o.asin=e.asin,o.keyword=e.keywords[r].keyword,n.next=9,new l.a(o);case 9:return u=n.sent,n.next=12,u.startScraper();case 12:h=n.sent,console.log("asin: ".concat(e.asin,", keyword: ").concat(e.keywords[r].keyword)),p=a,setTimeout((function(){p.$nextTick(Object(c["a"])(regeneratorRuntime.mark((function a(){var n,s,c;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(console.log(h),!(h.result.length>0)){a.next=9;break}return console.log("put for updating"),s=h.result.map((function(e){return{page:e.page,index:e.index,type:e.isAd?"ad":"normal",time:Number(((new Date).getTime()/1e3).toFixed(0))}})),(n=e.keywords[r].ranking).push.apply(n,Object(i["a"])(s)),a.next=7,p.$dbOperation.dbOperation("put",e,p.dbKeyList[t]);case 7:c=a.sent,console.log(c);case 9:case"end":return a.stop()}}),a)}))))}),1e3);case 16:case"end":return n.stop()}}),n)})))()}}},h=u,p=(r("034f"),r("2877")),f=Object(p["a"])(h,a,n,!1,null,null,null);t["default"]=f.exports},4:function(e,t){},4678:function(e,t,r){var a={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn-bd":"9686","./bn-bd.js":"9686","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-in":"ec2e","./en-in.js":"ec2e","./en-nz":"6f50","./en-nz.js":"6f50","./en-sg":"b7e9","./en-sg.js":"b7e9","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-mx":"b5b7","./es-mx.js":"b5b7","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fil":"d69a","./fil.js":"d69a","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-deva":"aaf2","./gom-deva.js":"aaf2","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./oc-lnc":"167b","./oc-lnc.js":"167b","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tk":"5aff","./tk.js":"5aff","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-mo":"3a6c","./zh-mo.js":"3a6c","./zh-tw":"90ea","./zh-tw.js":"90ea"};function n(e){var t=i(e);return r(t)}function i(e){if(!r.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}n.keys=function(){return Object.keys(a)},n.resolve=i,e.exports=n,n.id="4678"},5:function(e,t){},"56d7":function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var a=r("2b0e"),n=r("3dfd"),i=r("1da1"),s=(r("96cf"),r("caad"),r("d9e2"),r("d3b7"),["add","get","put","getAll","getAllKeys","delete"]),c={dbOperation:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t,r,a){var n,i,c,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(s.includes(t)){e.next=2;break}throw new Error("操作类型错误, 仅支持: ".concat(s.toString()," 方法"));case 2:return n="add"===t||"put"===t||"delete"===t?"readwrite":"readonly",e.next=5,this.dbInit();case 5:return i=e.sent,c=i.transaction("asin",n).objectStore("asin"),o=new Promise((function(e,n){var i;switch(t){case"add":i=c[t](r);break;case"get":i=c[t](r);break;case"put":i=c[t](r,a);break;case"getAll":i=c[t]();break;case"getAllKeys":i=c[t]();break;case"delete":i=c[t](a);break}i.onsuccess=function(t){e(t.target.result)},i.onerror=function(e){n(e)}})),e.abrupt("return",o);case 9:case"end":return e.stop()}}),e,this)})));function t(t,r,a){return e.apply(this,arguments)}return t}(),dbInit:function(){return new Promise((function(e,t){var r=window.indexedDB.open("data",1);r.onsuccess=function(t){e(t.target.result)},r.onupgradeneeded=function(e){var t=e.target.result;t.objectStoreNames.contains("asin")||t.createObjectStore("asin",{autoIncrement:!0})},r.onerror=function(e){t(e)}}))}},o=c,l=r("5c96"),d=r.n(l),u=(r("0fae"),r("3ca3"),r("ddb0"),r("8c4f"));a["default"].use(u["a"]);var h=[{path:"/",name:"root",component:function(){return Promise.resolve().then(r.bind(null,"3dfd"))},redirect:function(){return{name:"home"}},children:[{path:"home",name:"home",component:function(){return r.e("chunk-4a54513f").then(r.bind(null,"57da"))}},{path:"keyword",name:"keyword",component:function(){return r.e("chunk-25bfe4ba").then(r.bind(null,"a0d5"))}}]}],p=new u["a"]({mode:"hash",routes:h}),f=p;a["default"].config.productionTip=!1,a["default"].use(d.a),a["default"].prototype.$dbOperation=o,new a["default"]({router:f,render:function(e){return e(n["default"])}}).$mount("#app")},6:function(e,t){},7:function(e,t){},8:function(e,t){},"85ec":function(e,t,r){},9:function(e,t){},d697:function(e,t,r){r("ac1f"),r("466d"),r("5319"),r("498a");var a=r("c1df");e.exports={limit:{product:1e3,reviews:2e4},defaultItemLimit:15,reviewFilter:{sortBy:{recent:"recent",helpful:"helpful"},filterByStar:{positive:"positive",critical:"critical",1:"one_star",2:"two_star",3:"three_star",4:"four_star",5:"five_star"},formatType:{all_formats:"all_formats",current_format:"current_format"}},geo:{US:{country:"United States of America",currency:"USD",symbol:"$",host:"www.amazon.com",variants:{split_text:"Click to select "},best_seller:function(e){if(e){var t=e.match(/(#[\d,|]+) in[\s\n ]([\w&'\s]+)/);if(t)return{rank:parseInt(t[1].replace(/[^\d]/g,"")),category:t[2].trim()}}return""},review_date:function(e){var t=/on (.+)$/.exec(e);return t?{date:t[1],unix:a(new Date("".concat(t[1]," 02:00:00"))).utc().unix()}:""},price_format:function(e){var t=e.replace(/[^\d+\.]/g,"");return parseFloat(t)},product_information:{id:["#detailBullets_feature_div > ul","#productDetails_detailBullets_sections1","#productDetails_techSpec_section_1","#productDetails_techSpec_section_2","#detailBulletsWrapper_feature_div > ul:nth-child(5)"],fields:{"Amazon Best Sellers Rank":{key:"",rank:!0},"Best-sellers rank":{key:"",rank:!0},"Best Sellers Rank":{key:"",rank:!0},"Package Dimensions":{key:"dimensions"},"Product Dimensions":{key:"dimensions"},"Parcel Dimensions":{key:"dimensions"},"Item Weight":{key:"weight"},Manufacturer:{key:"manufacturer"},"Release date":{key:"available_from"},"Date First Available":{key:"available_from"},"Item model number":{key:"model_number"},Department:{key:"department"},Language:{key:"language"},Publisher:{key:"publisher"},"Reading level":{key:"reading_level"},"Grade Level":{key:"grade_level"},Hardcover:{key:"hardcover"},Paperback:{key:"paperback"},"ISBN-10":{key:"ISBN-10"},"ISBN-13":{key:"ISBN-13"}}}},AU:{country:"Australia",currency:"AUD",symbol:"$",host:"www.amazon.com.au",variants:{split_text:"Click to select "},best_seller:function(e){if(e){var t=e.match(/(#[\d,|]+) in[\s\n ]([\w&'\s]+)/);if(t)return{rank:parseInt(t[1].replace(/[^\d]/g,"")),category:t[2].trim()}}return""},review_date:function(e){var t=/on (.+)$/.exec(e);return t?{date:t[1],unix:a(new Date("".concat(t[1]," 02:00:00"))).utc().unix()}:""},price_format:function(e){var t=e.replace(/[^\d+\.]/g,"");return parseFloat(t)},product_information:{id:["#detailBullets_feature_div > ul","#productDetails_detailBullets_sections1","#productDetails_techSpec_section_1","#productDetails_techSpec_section_2","#detailBulletsWrapper_feature_div > ul:nth-child(5)"],fields:{"Amazon Best Sellers Rank":{key:"",rank:!0},"Best-sellers rank":{key:"",rank:!0},"Best Sellers Rank":{key:"",rank:!0},"Package Dimensions":{key:"dimensions"},"Product Dimensions":{key:"dimensions"},"Parcel Dimensions":{key:"dimensions"},"Item Weight":{key:"weight"},Manufacturer:{key:"manufacturer"},"Release date":{key:"available_from"},"Date First Available":{key:"available_from"},"Item model number":{key:"model_number"},Department:{key:"department"}}}},BR:{country:"Brazil",currency:"BRL",symbol:"R$",host:"www.amazon.com.br",variants:{split_text:"Click to select "},best_seller:function(e){if(e){var t=e.match(/(#[\d,|]+) in[\s\n ]([\w&'\s]+)/);if(t)return{rank:parseInt(t[1].replace(/[^\d]/g,"")),category:t[2].trim()}}return""},review_date:function(e){var t=/on (.+)$/.exec(e);return t?{date:t[1],unix:a(new Date("".concat(t[1]," 02:00:00"))).utc().unix()}:""},price_format:function(e){var t=e.replace(/[^\d+\,]/g,"");return parseFloat(t.replace(/,/g,"."))},product_information:{id:["#detailBullets_feature_div > ul","#productDetails_detailBullets_sections1","#productDetails_techSpec_section_1","#productDetails_techSpec_section_2","#detailBulletsWrapper_feature_div > ul:nth-child(5)"],fields:{"Amazon Best Sellers Rank":{key:"",rank:!0},"Best-sellers rank":{key:"",rank:!0},"Best Sellers Rank":{key:"",rank:!0},"Package Dimensions":{key:"dimensions"},"Product Dimensions":{key:"dimensions"},"Parcel Dimensions":{key:"dimensions"},"Item Weight":{key:"weight"},Manufacturer:{key:"manufacturer"},"Release date":{key:"available_from"},"Date First Available":{key:"available_from"},"Item model number":{key:"model_number"},Department:{key:"department"}}}},CA:{country:"Canada",currency:"CAD",symbol:"$",host:"www.amazon.ca",variants:{split_text:"Click to select "},best_seller:function(e){if(e){var t=e.match(/(#[\d,|]+) in[\s\n ]([\w&'\s]+)/);if(t)return{rank:parseInt(t[1].replace(/[^\d]/g,"")),category:t[2].trim()}}return""},review_date:function(e){var t=/on (.+)$/.exec(e);return t?{date:t[1],unix:a(new Date("".concat(t[1]," 02:00:00"))).utc().unix()}:""},price_format:function(e){var t=e.replace(/[^\d+\.]/g,"");return parseFloat(t)},product_information:{id:["#detailBullets_feature_div > ul","#productDetails_detailBullets_sections1","#productDetails_techSpec_section_1","#productDetails_techSpec_section_2","#detailBulletsWrapper_feature_div > ul:nth-child(5)"],fields:{"Amazon Best Sellers Rank":{key:"",rank:!0},"Best-sellers rank":{key:"",rank:!0},"Best Sellers Rank":{key:"",rank:!0},"Package Dimensions":{key:"dimensions"},"Product Dimensions":{key:"dimensions"},"Parcel Dimensions":{key:"dimensions"},"Item Weight":{key:"weight"},Manufacturer:{key:"manufacturer"},"Release date":{key:"available_from"},"Date First Available":{key:"available_from"},"Item model number":{key:"model_number"},Department:{key:"department"}}}},CN:{country:"China",currency:"CNY",host:"www.amazon.cn",symbol:"¥",variants:{split_text:"Click to select "},best_seller:function(e){if(e){var t=e.match(/(#[\d,|]+) in[\s\n ]([\w&'\s]+)/);if(t)return{rank:parseInt(t[1].replace(/[^\d]/g,"")),category:t[2].trim()}}return""},review_date:function(e){var t=/on (.+)$/.exec(e);return t?{date:t[1],unix:a(new Date("".concat(t[1]," 02:00:00"))).utc().unix()}:""},price_format:function(e){var t=e.replace(/[^\d+\.]/g,"");return parseFloat(t)},product_information:{id:["#detailBullets_feature_div > ul","#productDetails_detailBullets_sections1","#productDetails_techSpec_section_1","#productDetails_techSpec_section_2","#detailBulletsWrapper_feature_div > ul:nth-child(5)"],fields:{"Amazon Best Sellers Rank":{key:"",rank:!0},"Best-sellers rank":{key:"",rank:!0},"Best Sellers Rank":{key:"",rank:!0},"商品尺寸":{key:"dimensions"},"商品重量":{key:"weight"},"制造商":{key:"manufacturer"}}}},FR:{country:"France",currency:"EUR",host:"www.amazon.fr",symbol:"€",variants:{split_text:"Click to select "},best_seller:function(e){if(e){var t=e.match(/(#[\d,|]+) in[\s\n ]([\w&'\s]+)/);if(t)return{rank:parseInt(t[1].replace(/[^\d]/g,"")),category:t[2].trim()}}return""},review_date:function(e){var t=/on (.+)$/.exec(e);return t?{date:t[1],unix:a(new Date("".concat(t[1]," 02:00:00"))).utc().unix()}:""},price_format:function(e){var t=e.replace(/[^\d+\,]/g,"").replace(",",".");return parseFloat(t)},product_information:{id:["#detailBullets_feature_div > ul","#productDetails_detailBullets_sections1","#productDetails_techSpec_section_1","#productDetails_techSpec_section_2","#detailBulletsWrapper_feature_div > ul:nth-child(5)"],fields:{"Amazon Best Sellers Rank":{key:"",rank:!0},"Best-sellers rank":{key:"",rank:!0},"Best Sellers Rank":{key:"",rank:!0},"Package Dimensions":{key:"dimensions"},"Product Dimensions":{key:"dimensions"},"Parcel Dimensions":{key:"dimensions"},"Item Weight":{key:"weight"},Manufacturer:{key:"manufacturer"},"Release date":{key:"available_from"},"Date First Available":{key:"available_from"},"Item model number":{key:"model_number"},Department:{key:"department"}}}},DE:{country:"Germany",currency:"EUR",host:"www.amazon.de",symbol:"€",variants:{split_text:"Click to select "},best_seller:function(e){if(e){var t=e.match(/(#[\d,|]+) in[\s\n ]([\w&'\s]+)/);if(t)return{rank:parseInt(t[1].replace(/[^\d]/g,"")),category:t[2].trim()}}return""},review_date:function(e){var t=/on (.+)$/.exec(e);return t?{date:t[1],unix:a(new Date("".concat(t[1]," 02:00:00"))).utc().unix()}:""},price_format:function(e){var t=e.replace(/[^\d+\.]/g,"");return parseFloat(t)},product_information:{id:["#detailBullets_feature_div > ul","#productDetails_detailBullets_sections1","#productDetails_techSpec_section_1","#productDetails_techSpec_section_2","#detailBulletsWrapper_feature_div > ul:nth-child(5)"],fields:{"Amazon Best Sellers Rank":{key:"",rank:!0},"Best-sellers rank":{key:"",rank:!0},"Best Sellers Rank":{key:"",rank:!0},"Package Dimensions":{key:"dimensions"},"Product Dimensions":{key:"dimensions"},"Parcel Dimensions":{key:"dimensions"},"Item Weight":{key:"weight"},Manufacturer:{key:"manufacturer"},"Release date":{key:"available_from"},"Date First Available":{key:"available_from"},"Item model number":{key:"model_number"},Department:{key:"department"}}}},IN:{country:"India",currency:"INR",host:"www.amazon.in",symbol:"₹",variants:{split_text:"Click to select "},best_seller:function(e){if(e){var t=e.match(/(#[\d,|]+) in[\s\n ]([\w&'\s]+)/);if(t)return{rank:parseInt(t[1].replace(/[^\d]/g,"")),category:t[2].trim()}}return""},review_date:function(e){var t=/on (.+)$/.exec(e);return t?{date:t[1],unix:a(new Date("".concat(t[1]," 02:00:00"))).utc().unix()}:""},price_format:function(e){var t=e.replace(/[^\d+\.]/g,"");return parseFloat(t)},product_information:{id:["#detailBullets_feature_div > ul","#productDetails_detailBullets_sections1","#productDetails_techSpec_section_1","#productDetails_techSpec_section_2","#detailBulletsWrapper_feature_div > ul:nth-child(5)"],fields:{"Amazon Best Sellers Rank":{key:"",rank:!0},"Best-sellers rank":{key:"",rank:!0},"Best Sellers Rank":{key:"",rank:!0},"Package Dimensions":{key:"dimensions"},"Product Dimensions":{key:"dimensions"},"Parcel Dimensions":{key:"dimensions"},"Item Weight":{key:"weight"},Manufacturer:{key:"manufacturer"},"Release date":{key:"available_from"},"Date First Available":{key:"available_from"},"Item model number":{key:"model_number"},Department:{key:"department"}}}},IT:{country:"Italy",currency:"EUR",host:"www.amazon.it",symbol:"€",variants:{split_text:"Click to select "},best_seller:function(e){if(e){var t=e.match(/(#[\d,|]+) in[\s\n ]([\w&'\s]+)/);if(t)return{rank:parseInt(t[1].replace(/[^\d]/g,"")),category:t[2].trim()}}return""},review_date:function(e){var t=/on (.+)$/.exec(e);return t?{date:t[1],unix:a(new Date("".concat(t[1]," 02:00:00"))).utc().unix()}:""},price_format:function(e){var t=e.replace(/[^\d+\,]/g,"").replace(",",".");return parseFloat(t)},product_information:{id:["#detailBullets_feature_div > ul","#productDetails_detailBullets_sections1","#productDetails_techSpec_section_1","#productDetails_techSpec_section_2","#detailBulletsWrapper_feature_div > ul:nth-child(5)"],fields:{"Amazon Best Sellers Rank":{key:"",rank:!0},"Best-sellers rank":{key:"",rank:!0},"Best Sellers Rank":{key:"",rank:!0},"Package Dimensions":{key:"dimensions"},"Product Dimensions":{key:"dimensions"},"Parcel Dimensions":{key:"dimensions"},"Item Weight":{key:"weight"},Manufacturer:{key:"manufacturer"},"Release date":{key:"available_from"},"Date First Available":{key:"available_from"},"Item model number":{key:"model_number"},Department:{key:"department"}}}},MX:{country:"Mexico",currency:"MXN",host:"www.amazon.com.mx",symbol:"M$",review_date:function(e){var t=/on (.+)$/.exec(e);return t?{date:t[1],unix:a(new Date("".concat(t[1]," 02:00:00"))).utc().unix()}:""},price_format:function(e){var t=e.replace(/[^\d+\.]/g,"");return parseFloat(t)},variants:{split_text:"Click to select "},best_seller:function(e){if(e){var t=e.match(/(#[\d,|]+) in[\s\n ]([\w&'\s]+)/);if(t)return{rank:parseInt(t[1].replace(/[^\d]/g,"")),category:t[2].trim()}}return""},product_information:{id:["#detailBullets_feature_div > ul","#productDetails_detailBullets_sections1","#productDetails_techSpec_section_1","#productDetails_techSpec_section_2","#detailBulletsWrapper_feature_div > ul:nth-child(5)"],fields:{"Amazon Best Sellers Rank":{key:"",rank:!0},"Best-sellers rank":{key:"",rank:!0},"Best Sellers Rank":{key:"",rank:!0},"Package Dimensions":{key:"dimensions"},"Product Dimensions":{key:"dimensions"},"Parcel Dimensions":{key:"dimensions"},"Item Weight":{key:"weight"},Manufacturer:{key:"manufacturer"},"Release date":{key:"available_from"},"Date First Available":{key:"available_from"},"Item model number":{key:"model_number"},Department:{key:"department"}}}},NL:{country:"Netherlands",currency:"EUR",host:"www.amazon.nl",symbol:"€",review_date:function(e){var t=/on (.+)$/.exec(e);return t?{date:t[1],unix:a(new Date("".concat(t[1]," 02:00:00"))).utc().unix()}:""},price_format:function(e){var t=e.replace(/[^\d+\,]/g,"").replace(",",".");return parseFloat(t)},variants:{split_text:"Click to select "},best_seller:function(e){if(e){var t=e.match(/(#[\d,|]+) in[\s\n ]([\w&'\s]+)/);if(t)return{rank:parseInt(t[1].replace(/[^\d]/g,"")),category:t[2].trim()}}return""},product_information:{id:["#detailBullets_feature_div > ul","#productDetails_detailBullets_sections1","#productDetails_techSpec_section_1","#productDetails_techSpec_section_2","#detailBulletsWrapper_feature_div > ul:nth-child(5)"],fields:{"Amazon Best Sellers Rank":{key:"",rank:!0},"Best-sellers rank":{key:"",rank:!0},"Best Sellers Rank":{key:"",rank:!0},"Package Dimensions":{key:"dimensions"},"Product Dimensions":{key:"dimensions"},"Parcel Dimensions":{key:"dimensions"},"Item Weight":{key:"weight"},Manufacturer:{key:"manufacturer"},"Release date":{key:"available_from"},"Date First Available":{key:"available_from"},"Item model number":{key:"model_number"},Department:{key:"department"}}}},SG:{country:"Singapore",currency:"SGD",host:"www.amazon.sg",symbol:"$",variants:{split_text:"Click to select "},best_seller:function(e){if(e){var t=e.match(/(#[\d,|]+) in[\s\n ]([\w&'\s]+)/);if(t)return{rank:parseInt(t[1].replace(/[^\d]/g,"")),category:t[2].trim()}}return""},review_date:function(e){var t=/on (.+)$/.exec(e);return t?{date:t[1],unix:a(new Date("".concat(t[1]," 02:00:00"))).utc().unix()}:""},price_format:function(e){var t=e.replace(/[^\d+\.]/g,"");return parseFloat(t)},product_information:{id:["#detailBullets_feature_div > ul","#productDetails_detailBullets_sections1","#productDetails_techSpec_section_1","#productDetails_techSpec_section_2","#detailBulletsWrapper_feature_div > ul:nth-child(5)"],fields:{"Amazon Best Sellers Rank":{key:"",rank:!0},"Best-sellers rank":{key:"",rank:!0},"Best Sellers Rank":{key:"",rank:!0},"Package Dimensions":{key:"dimensions"},"Product Dimensions":{key:"dimensions"},"Parcel Dimensions":{key:"dimensions"},"Item Weight":{key:"weight"},Manufacturer:{key:"manufacturer"},"Release date":{key:"available_from"},"Date First Available":{key:"available_from"},"Item model number":{key:"model_number"},Department:{key:"department"}}}},ES:{country:"Spain",currency:"EUR",host:"www.amazon.es",symbol:"€",variants:{split_text:"Click to select "},best_seller:function(e){if(e){var t=e.match(/(#[\d,|]+) in[\s\n ]([\w&'\s]+)/);if(t)return{rank:parseInt(t[1].replace(/[^\d]/g,"")),category:t[2].trim()}}return""},review_date:function(e){var t=/on (.+)$/.exec(e);return t?{date:t[1],unix:a(new Date("".concat(t[1]," 02:00:00"))).utc().unix()}:""},price_format:function(e){var t=e.replace(/[^\d+\,]/g,"").replace(",",".");return parseFloat(t)},product_information:{id:["#detailBullets_feature_div > ul","#productDetails_detailBullets_sections1","#productDetails_techSpec_section_1","#productDetails_techSpec_section_2","#detailBulletsWrapper_feature_div > ul:nth-child(5)"],fields:{"Amazon Best Sellers Rank":{key:"",rank:!0},"Best-sellers rank":{key:"",rank:!0},"Best Sellers Rank":{key:"",rank:!0},"Dimensiones del producto":{key:"dimensions"},Fabricante:{key:"manufacturer"},"Producto en Amazon.es desde":{key:"available_from"},"Item model number":{key:"model_number"},Departamento:{key:"department"}}}},TR:{country:"Turkey",currency:"TRY",host:"www.amazon.com.tr",symbole:"₺",variants:{split_text:"Click to select "},best_seller:function(e){if(e){var t=e.match(/(#[\d,|]+) in[\s\n ]([\w&'\s]+)/);if(t)return{rank:parseInt(t[1].replace(/[^\d]/g,"")),category:t[2].trim()}}return""},review_date:function(e){var t=/on (.+)$/.exec(e);return t?{date:t[1],unix:a(new Date("".concat(t[1]," 02:00:00"))).utc().unix()}:""},price_format:function(e){var t=e.replace(/[^\d+\,]/g,"").replace(",",".");return parseFloat(t)},product_information:{id:["#detailBullets_feature_div > ul","#productDetails_detailBullets_sections1","#productDetails_techSpec_section_1","#productDetails_techSpec_section_2","#detailBulletsWrapper_feature_div > ul:nth-child(5)"],fields:{"Amazon Best Sellers Rank":{key:"",rank:!0},"Best-sellers rank":{key:"",rank:!0},"Best Sellers Rank":{key:"",rank:!0},"Ürün Boyutları":{key:"dimensions"},"Ürün Ağırlığı":{key:"weight"},"Üretici":{key:"manufacturer"},"Satışa Sunulduğu İlk Tarih":{key:"available_from"},"Model Numarası":{key:"model_number"},Department:{key:"department"}}}},AE:{country:"United Arab Emirates",currency:"AED",host:"www.amazon.ae",symbol:"د.إ",variants:{split_text:"Click to select "},best_seller:function(e){if(e){var t=e.match(/(#[\d,|]+) in[\s\n ]([\w&'\s]+)/);if(t)return{rank:parseInt(t[1].replace(/[^\d]/g,"")),category:t[2].trim()}}return""},review_date:function(e){var t=/on (.+)$/.exec(e);return t?{date:t[1],unix:a(new Date("".concat(t[1]," 02:00:00"))).utc().unix()}:""},price_format:function(e){var t=e.replace(/[^\d+\.]/g,"");return parseFloat(t)},product_information:{id:["#detailBullets_feature_div > ul","#productDetails_detailBullets_sections1","#productDetails_techSpec_section_1","#productDetails_techSpec_section_2","#detailBulletsWrapper_feature_div > ul:nth-child(5)"],fields:{"Amazon Best Sellers Rank":{key:"",rank:!0},"Best-sellers rank":{key:"",rank:!0},"Best Sellers Rank":{key:"",rank:!0},"Package Dimensions":{key:"dimensions"},"Product Dimensions":{key:"dimensions"},"Parcel Dimensions":{key:"dimensions"},"Item Weight":{key:"weight"},Manufacturer:{key:"manufacturer"},"Release date":{key:"available_from"},"Date First Available":{key:"available_from"},"Item model number":{key:"model_number"},Department:{key:"department"}}}},GB:{country:"United Kingdom",currency:"GBP",host:"www.amazon.co.uk",symbol:"£",variants:{split_text:"Click to select "},best_seller:function(e){if(e){var t=e.match(/(#[\d,|]+) in[\s\n ]([\w&'\s]+)/);if(t)return{rank:parseInt(t[1].replace(/[^\d]/g,"")),category:t[2].trim()}}return""},review_date:function(e){var t=/on (.+)$/.exec(e);return t?{date:t[1],unix:a(new Date("".concat(t[1]," 02:00:00"))).utc().unix()}:""},price_format:function(e){var t=e.replace(/[^\d+\.]/g,"");return parseFloat(t)},product_information:{id:["#detailBullets_feature_div > ul","#productDetails_detailBullets_sections1","#productDetails_techSpec_section_1","#productDetails_techSpec_section_2","#detailBulletsWrapper_feature_div > ul:nth-child(5)"],fields:{"Amazon Best Sellers Rank":{key:"",rank:!0},"Best-sellers rank":{key:"",rank:!0},"Best Sellers Rank":{key:"",rank:!0},"Package Dimensions":{key:"dimensions"},"Product Dimensions":{key:"dimensions"},"Parcel Dimensions":{key:"dimensions"},"Item Weight":{key:"weight"},Manufacturer:{key:"manufacturer"},"Release date":{key:"available_from"},"Date First Available":{key:"available_from"},"Item model number":{key:"model_number"},Department:{key:"department"}}}},JP:{country:"Japan",currency:"JPY",host:"www.amazon.jp",symbol:"¥",variants:{split_text:"Click to select "},best_seller:function(e){if(e){var t=e.match(/(#[\d,|]+) in[\s\n ]([\w&'\s]+)/);if(t)return{rank:parseInt(t[1].replace(/[^\d]/g,"")),category:t[2].trim()}}return""},review_date:function(e){var t=/on (.+)$/.exec(e);return t?{date:t[1],unix:a(new Date("".concat(t[1]," 02:00:00"))).utc().unix()}:""},price_format:function(e){var t=e.replace(/[^\d+]/g,"");return parseFloat(t)},product_information:{id:["#detailBullets_feature_div > ul","#productDetails_detailBullets_sections1","#productDetails_techSpec_section_1","#productDetails_techSpec_section_2","#detailBulletsWrapper_feature_div > ul:nth-child(5)"],fields:{"Amazon Best Sellers Rank":{key:"",rank:!0},"Best-sellers rank":{key:"",rank:!0},"Best Sellers Rank":{key:"",rank:!0},"梱包サイズ":{key:"dimensions"},"発売日":{key:"available_from"},"商品の重量":{key:"weight"}}}},SE:{country:"Sweden",currency:"SEK",symbol:"kr",host:"www.amazon.se",variants:{split_text:"Click to select "},best_seller:function(e){if(e){var t=e.match(/(#[\d,|]+) in[\s\n ]([\w&'\s]+)/);if(t)return{rank:parseInt(t[1].replace(/[^\d]/g,"")),category:t[2].trim()}}return""},review_date:function(e){var t=/on (.+)$/.exec(e);return t?{date:t[1],unix:a(new Date("".concat(t[1]," 02:00:00"))).utc().unix()}:""},price_format:function(e){var t=e.replace(/[^\d+\,]/g,"");return parseFloat(t.replace(/,/g,"."))},product_information:{id:["#detailBullets_feature_div > ul","#productDetails_detailBullets_sections1","#productDetails_techSpec_section_1","#productDetails_techSpec_section_2","#detailBulletsWrapper_feature_div > ul:nth-child(5)"],fields:{"Amazon Best Sellers Rank":{key:"",rank:!0},"Best-sellers rank":{key:"",rank:!0},"Best Sellers Rank":{key:"",rank:!0},"Package Dimensions":{key:"dimensions"},"Product Dimensions":{key:"dimensions"},"Parcel Dimensions":{key:"dimensions"},"Item Weight":{key:"weight"},Manufacturer:{key:"manufacturer"},"Release date":{key:"available_from"},"Date First Available":{key:"available_from"},"Item model number":{key:"model_number"},Department:{key:"department"}}}},PL:{country:"Poland",currency:"Zł",symbol:"zł",host:"www.amazon.pl",variants:{split_text:"Click to select "},best_seller:function(e){if(e){var t=e.match(/(#[\d,|]+) in[\s\n ]([\w&'\s]+)/);if(t)return{rank:parseInt(t[1].replace(/[^\d]/g,"")),category:t[2].trim()}}return""},review_date:function(e){var t=/on (.+)$/.exec(e);return t?{date:t[1],unix:a(new Date("".concat(t[1]," 02:00:00"))).utc().unix()}:""},price_format:function(e){var t=e.replace(/[^\d+\,]/g,"");return parseFloat(t.replace(/,/g,"."))},product_information:{id:["#detailBullets_feature_div > ul","#productDetails_detailBullets_sections1","#productDetails_techSpec_section_1","#productDetails_techSpec_section_2","#detailBulletsWrapper_feature_div > ul:nth-child(5)"],fields:{"Amazon Best Sellers Rank":{key:"",rank:!0},"Best-sellers rank":{key:"",rank:!0},"Best Sellers Rank":{key:"",rank:!0},"Package Dimensions":{key:"dimensions"},"Product Dimensions":{key:"dimensions"},"Parcel Dimensions":{key:"dimensions"},"Item Weight":{key:"weight"},Manufacturer:{key:"manufacturer"},"Release date":{key:"available_from"},"Date First Available":{key:"available_from"},"Item model number":{key:"model_number"},Department:{key:"department"}}}}}}},e700:function(e,t,r){var a=r("278c").default,n=r("6374").default,i=r("448a").default,s=r("ded3").default,c=r("c973").default,o=r("970b").default,l=r("5bc3").default;r("96cf"),r("4e82"),r("99af"),r("d3b7"),r("d9e2"),r("ac1f"),r("5319"),r("25f0"),r("1276"),r("a9e3"),r("466d"),r("e9c4"),r("3ca3"),r("ddb0"),r("159b"),r("4de4"),r("d81d"),r("b64b"),r("b0c0"),r("a4d3"),r("e01a"),r("fb6a"),r("b680"),r("498a");var d=r("52b3"),u=r("2f24"),h=u.forEachLimit,p=r("3e8f"),f=p.writeFile,m=r("f684"),v=m.fromCallback,_=r("1431"),y=r("f59f"),k=y.Parser,b=r("c1df"),g=r("d697"),w=function(){"use strict";function e(t){var r=t.keyword,a=t.number,n=t.sponsored,i=t.proxy,s=t.cli,c=t.filetype,l=t.scrapeType,d=t.asin,u=t.sort,h=t.discount,p=(t.rating,t.ua),f=t.timeout,m=t.randomUa,v=t.page,_=t.bulk,y=t.category,b=t.cookie,g=t.geo,w=t.asyncTasks,x=t.reviewFilter,D=t.referer,j=t.asyncPage;o(this,e),this.asyncTasks=w,this.asyncPage=j,this.mainHost="https://divine-bread-7a03.amazontool.workers.dev",this.geo=g,this.cookie=b,this.bulk=_,this.productSearchCategory=y,this.collector=[],this.keyword=r,this.number=parseInt(a,10),this.searchPage=v,this.sponsored=n,this.proxy=i,this.cli=s,this.scrapeType=l,this.asin=d,this.sort=u,this.discount=h,this.minRating=1,this.maxRating=5,this.timeout=f,this.randomUa=m,this.totalProducts=0,this.reviewMetadata={total_reviews:0,stars_stat:{}},this.referer=D,this.fileType=c,this.jsonToCsv=new k({flatten:!0}),this.initTime=Date.now(),this.ua=p||"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.113 Safari/537.36",this.reviewFilter=x,this.ranking=[]}return l(e,[{key:"userAgent",get:function(){var e=["Macintosh; Intel Mac OS X 10_15_7","Macintosh; Intel Mac OS X 10_15_5","Macintosh; Intel Mac OS X 10_11_6","Macintosh; Intel Mac OS X 10_6_6","Macintosh; Intel Mac OS X 10_9_5","Macintosh; Intel Mac OS X 10_10_5","Macintosh; Intel Mac OS X 10_7_5","Macintosh; Intel Mac OS X 10_11_3","Macintosh; Intel Mac OS X 10_10_3","Macintosh; Intel Mac OS X 10_6_8","Macintosh; Intel Mac OS X 10_10_2","Macintosh; Intel Mac OS X 10_10_3","Macintosh; Intel Mac OS X 10_11_5","Windows NT 10.0; Win64; x64","Windows NT 10.0; WOW64","Windows NT 10.0"];return"Mozilla/5.0 (".concat(e[Math.floor(Math.random()*e.length)],") AppleWebKit/537.36 (KHTML, like Gecko) Chrome/").concat(Math.floor(3*Math.random())+85,".0.").concat(Math.floor(190*Math.random())+4100,".").concat(Math.floor(50*Math.random())+140," Safari/537.36")}},{key:"getReferer",get:function(){return Array.isArray(this.referer)?this.referer[Math.floor(Math.random()*this.referer.length)]:""}},{key:"getProxy",get:function(){return{socks:!1,proxy:""}}},{key:"httpRequest",value:function(e){var t=this,r=e.uri,a=e.method,n=e.qs,i=e.json,o=e.body,l=e.form,u=this.getProxy;return new Promise(function(){var e=c(regeneratorRuntime.mark((function e(c,h){var p,f;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return p=s(s(s(s(s(s({uri:r?"".concat(t.mainHost,"/").concat(r):t.mainHost,method:a},n?{qs:n}:{}),o?{body:o}:{}),l?{form:l}:{}),{},{headers:s(s(s(s(s(s({"user-agent":t.userAgent,cookie:t.cookie,accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8","accept-language":"en-US,en;q=0.9","accept-encoding":"gzip, deflate, br"},t.getReferer?{referer:t.getReferer}:{}),Math.round(Math.random())?{downlink:Math.floor(30*Math.random())+10}:{}),Math.round(Math.random())?{rtt:Math.floor(100*Math.random())+50}:{}),Math.round(Math.random())?{pragma:"no-cache"}:{}),Math.round(Math.random())?{ect:"4g"}:{}),Math.round(Math.random())?{DNT:1}:{}),strictSSL:!1},i?{json:!0}:{}),{},{gzip:!0,resolveWithFullResponse:!0},u.proxy&&u.socks?{agent:u.proxy}:{}),u.proxy&&!u.socks?{proxy:"http://".concat(u.proxy,"/")}:{}),e.prev=1,e.next=4,d(p);case 4:f=e.sent,setTimeout((function(){c(f)}),t.timeout),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](1),h(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,r){return e.apply(this,arguments)}}())}},{key:"startScraper",value:function(){var e=c(regeneratorRuntime.mark((function e(){var t,r,a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("products"!==this.scrapeType){e.next=8;break}if(this.asyncPage=Math.ceil(this.number/15),this.keyword){e.next=4;break}throw new Error("Keyword is missing");case 4:if(!(this.number>g.limit.product)){e.next=6;break}throw new Error("Wow.... slow down cowboy. Maximum you can get is ".concat(g.limit.product," products"));case 6:if("boolean"===typeof this.sponsored){e.next=8;break}throw new Error("Sponsored can only be {true} or {false}");case 8:if("reviews"!==this.scrapeType){e.next=21;break}return e.next=11,this.buildRequest(1);case 11:if(t=e.sent,r=_.load(t.replace(/\s\s+/g,"").replace(/\n/g,"")),a=r(r("#filter-info-section")[0].children[0].children[0]).text().toString(),n=a.split(", ")[1].split(" ")[0],this.number=Number(n.replace(/,/g,"")),this.asyncPage=Math.ceil(this.number/10),this.asin){e.next=19;break}throw new Error("ASIN is missing");case 19:if(!(this.number>g.limit.reviews)){e.next=21;break}throw new Error("Wow.... slow down cowboy. Maximum you can get is ".concat(g.limit.reviews," reviews"));case 21:if("asin"!==this.scrapeType){e.next=24;break}if(this.asin){e.next=24;break}throw new Error("ASIN is missing");case 24:return e.next=26,this.mainLoop();case 26:return this.sortAndFilterResult(),e.next=29,this.saveResultToFile();case 29:return this.fileType&&this.cli&&console.log("Result was saved to: ".concat(this.fileName)),e.abrupt("return",s(s(s({},"products"===this.scrapeType?{totalProducts:this.totalProducts,category:this.productSearchCategory}:{}),"reviews"===this.scrapeType?s({},this.reviewMetadata):{}),{},{result:this.collector}));case 31:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"mainLoop",value:function(){var e=c(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){h([1,2,3,4,5],t.asyncTasks,function(){var r=c(regeneratorRuntime.mark((function r(a){var n,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.buildRequest(t.bulk?a:t.searchPage);case 2:if(n=r.sent,"asin"!==t.scrapeType){r.next=6;break}throw t.grapAsinDetails(n),new Error("Done");case 6:if("products"===t.scrapeType&&(i=n.match(/"totalResultCount":\w+(.[0-9])/gm),i&&(t.totalProducts=i[0].split('totalResultCount":')[1]),t.grabProduct(n,a)),"reviews"===t.scrapeType&&t.grabReviews(n),"ranking"===t.scrapeType&&t.grabRanking(n,a),t.bulk){r.next=11;break}throw new Error("Done");case 11:e();case 12:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),(function(t){t&&"Done"!=t.message&&r(t),e()}))})));case 1:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"fileName",get:function(){switch(this.scrapeType){case"products":return"".concat(this.scrapeType,"(").concat(this.keyword,")_").concat(this.initTime);case"reviews":case"asin":return"".concat(this.scrapeType,"(").concat(this.asin,")_").concat(this.initTime);default:throw new Error("Unknow scraping type: ".concat(this.scrapeType))}}},{key:"saveResultToFile",value:function(){var e=c(regeneratorRuntime.mark((function e(){var t,r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.collector.length){e.next=23;break}e.t0=this.fileType,e.next="json"===e.t0?4:"csv"===e.t0?7:"all"===e.t0?11:22;break;case 4:return e.next=6,v((function(e){return f("".concat(r.fileName,".json"),JSON.stringify(r.collector),e)}));case 6:return e.abrupt("break",23);case 7:return t=this.fileName,e.next=10,v((function(e){return f("".concat(t,".csv"),r.jsonToCsv.parse(r.collector),e)}));case 10:return e.abrupt("break",23);case 11:return e.t1=Promise,e.next=14,v((function(e){return f("".concat(r.fileName,".json"),JSON.stringify(r.collector),e)}));case 14:return e.t2=e.sent,e.next=17,v((function(e){return f("".concat(r.fileName,".csv"),r.jsonToCsv.parse(r.collector),e)}));case 17:return e.t3=e.sent,e.t4=[e.t2,e.t3],e.next=21,e.t1.all.call(e.t1,e.t4);case 21:return e.abrupt("break",23);case 22:return e.abrupt("break",23);case 23:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"sortAndFilterResult",value:function(){var e=this;"reviews"===this.scrapeType&&this.sort&&this.collector.sort((function(e,t){return t.rating-e.rating})),"products"===this.scrapeType&&(this.collector.sort((function(e,t){return e.position.global_position-t.position.global_position})),this.collector.forEach((function(e,t){e.position.global_position=t+=1})),this.sort&&this.collector.sort((function(e,t){return t.score-e.score})),this.discount&&(this.collector=this.collector.filter((function(e){return e.discounted}))),this.sponsored&&(this.collector=this.collector.filter((function(e){return e.sponsored})))),"products"!==this.scrapeType&&"reviews"!==this.scrapeType||(this.collector=this.collector.filter((function(t){return e.validateRating(t)}))),"ranking"===this.scrapeType&&(this.collector=this.ranking)}},{key:"setRequestEndpoint",get:function(){switch(this.scrapeType){case"ranking":return"s";case"products":return"s";case"reviews":return"product-reviews/".concat(this.asin,"/ref=cm_cr_arp_d_viewopt_srt?formatType=").concat(g.reviewFilter.formatType[this.reviewFilter.formatType],"&sortBy=").concat(g.reviewFilter.sortBy[this.reviewFilter.sortBy]?g.reviewFilter.sortBy[this.reviewFilter.sortBy]:"").concat(this.reviewFilter.verifiedPurchaseOnly?"&reviewerType=avp_only_reviews":"").concat(this.reviewFilter.filterByStar?"&filterByStar=".concat(g.reviewFilter.filterByStar[this.reviewFilter.filterByStar]):"");case"asin":return"dp/".concat(this.asin,"/ref=sspa_dk_detail_3&th=1&psc=1?th=1&psc=1");default:return""}}},{key:"buildRequest",value:function(){var e=c(regeneratorRuntime.mark((function e(t){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r={method:"GET",uri:this.setRequestEndpoint,qs:s(s({},"products"===this.scrapeType||"ranking"===this.scrapeType?s(s({k:this.keyword},this.productSearchCategory?{i:this.productSearchCategory}:{}),t>1?{page:t,ref:"sr_pg_".concat(t)}:{}):{}),"reviews"===this.scrapeType?s({},t>1?{pageNumber:t}:{}):{})},e.prev=1,e.next=4,this.httpRequest(r);case 4:return a=e.sent,e.abrupt("return",a.body);case 8:throw e.prev=8,e.t0=e["catch"](1),e.t0.message;case 11:case"end":return e.stop()}}),e,this,[[1,8]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"grabRanking",value:function(e,t){var r,a=this.asin,n=_.load(e.replace(/\s\s+/g,"").replace(/\n/g,"")),s=n(".s-main-slot").children().filter((function(e,t){return n(this).data("asin").length>0&&n(this).data("asin")===a})).map((function(e,r){var i=n(this).data("asin");if(a===i)return{page:t,index:n(this).data("index"),isAd:n(this).has(".a-spacing-micro").length>0}}));s.length>0&&(r=this.ranking).push.apply(r,i(s))}},{key:"grabReviews",value:function(e){var t=this,r=_.load(e.replace(/\s\s+/g,"").replace(/\n/g,"")),a=r("#histogramTable > tbody")[0];try{a.children.forEach((function(e){var a=parseInt(r(e.children[0]).text(),10),n=r(e.children[2]).text();t.reviewMetadata.stars_stat[a]=n}))}catch(I){return}this.reviewMetadata.total_reviews=parseInt(r(".averageStarRatingNumerical").text(),10);for(var n=r("#cm_cr-review_list")[0].children,i={},s=0;s<n.length;s++){var c=Object.keys(i).length+this.collector.length;if(c>=this.number&&this.bulk)break;var o=n[s].attribs["id"];o&&(i[o]={id:o})}for(var l in i){var d=r("#".concat(l,' [data-hook="review-date"]'));i[l].asin={original:this.asin,variant:""};try{i[l].review_data=d[0].children[0].data,i[l].review_data&&(i[l].date=this.geo.review_date(i[l].review_data))}catch(P){continue}}for(var u in i){var h=r("#".concat(u," div.a-row.a-spacing-mini.review-data.review-format-strip > a"));try{var p=h[0].attribs.href,f=/product-reviews\/(\w+)\//.exec(p);f&&(i[u].asin.variant=f[1])}catch(P){continue}}for(var m in i){var v=r("#".concat(m," .a-profile-name"));try{i[m].name=v[0].children[0].data}catch(P){continue}}for(var y in i){var k=r("#".concat(y,' [data-hook="review-star-rating"]'));try{i[y].rating=parseFloat(k[0].children[0].children[0].data.split(" ")[0])}catch(P){continue}}for(var b in i){var g=r("#".concat(b,' [data-hook="review-title"]'));try{i[b].title=r(g[0]).text().toString()}catch(P){continue}}var w=function(e){var t=r("#".concat(e,' [data-hook="format-strip"]'));try{t[0]&&t[0].children.forEach((function(t){if("text"==t.type){var a=r(t).text().toString().split(":");i[e][a[0]]=a[1]}}))}catch(P){return"continue"}};for(var x in i)w(x);for(var D in i){var j=r("#".concat(D,' [data-hook="review-body"]'));try{i[D].review=r(j[0]).text()}catch(P){continue}}for(var S in i){var B=r("#".concat(S,' [data-reftag="cm_cr_arp_d_rvw_rvwer"]'));i[S].verified_purchase=!1;try{i[S].verified_purchase=!!B[0]}catch(P){continue}}for(var R in i)this.collector.push(i[R])}},{key:"extractProductFeatures",value:function(e){var t=[];try{var r=e("#feature-bullets > ul .a-list-item");for(var a in r)r[a].children[0].data&&t.push(r[a].children[0].data)}catch(l){}try{var i,s=e("#feature-bullets > div > div")[0].children[0].children,c=n(s);try{for(c.s();!(i=c.n()).done;){var o=i.value;o.children[0].children[0].data&&t.push(o.children[0].children[0].data)}}catch(d){c.e(d)}finally{c.f()}}catch(u){}return t}},{key:"extractProductInfromation",value:function(e){var t=this,r=[],a={dimensions:"",weight:"",available_from:"",available_from_utc:"",available_for_months:0,available_for_days:0,manufacturer:"",model_number:"",department:""},i=!1;try{var c=e("#SalesRank > ul > li");for(var o in c){var l=e(c[o].children[0]).text(),d=e(c[o].children[1]).text(),u=c[o].children[1].children[1].attribs.href;if(d&&l){var h=this.geo.best_seller("".concat(l," ").concat(d));h&&r.push(s(s({},h),{},{link:"".concat(this.mainHost).concat(u)}))}}}catch(z){}try{var p=e(".prodDetSectionEntry")[0].parent.children[1].children[0];p.children.forEach((function(a){var n=t.geo.best_seller(e(a).text());n&&r.push(s(s({},n),{},{link:"".concat(t.mainHost).concat(a.next.attribs.href)}))}))}catch(A){}try{var f=e("#detailBulletsWrapper_feature_div > ul:nth-child(5) > li > span")[0];f.children.forEach((function(a){if("text"===a.type&&""!=a.data){var n=t.geo.best_seller(a.data);n&&r.push(s(s({},n),{},{link:"".concat(t.mainHost).concat(a.next.attribs.href)}))}"tag"===a.type&&"ul"===a.name&&a.children&&a.children.forEach((function(a){var n=e(a.children[0].children[0]).text(),i=e(a.children[0].children[1]).text(),c=a.children[0].children[1].attribs.href;if(i&&n){var o=t.geo.best_seller("".concat(n," ").concat(i));o&&r.push(s(s({},o),{},{link:"".concat(t.mainHost).concat(c)}))}}))}))}catch(F){}try{var m,v=n(this.geo.product_information.id);try{for(v.s();!(m=v.n()).done;){var _=m.value,y=e(_);if(y[0]){var k=y[0].children.length,g=y[0].children;1===k&&(g=y[0].children[0].children);var w,x=n(g);try{for(x.s();!(w=x.n()).done;){var D=w.value,j="",S="";if(1===k)try{"#detailBulletsWrapper_feature_div > ul:nth-child(5)"===_?(i=!0,j=D.children[0].data,S=D.children[1].data):(j=D.children[0].children[0].data,S=D.children[1].children[0].data)}catch(O){}else try{j=D.children[0].children[0].children[0].data.replace(":",""),S=D.children[0].children[1].children[0].data}catch(C){}var B=this.geo.product_information.fields[j];if(B){if(B.rank)try{var R=[];R=i?D.children[1].children:D.children[1].children[0].children,R.forEach((function(a){if("span"===a.name){var n=t.geo.best_seller(e(a).text()),i=a.children[1].attribs.href;n&&r.push(s(s({},n),{},{link:"".concat(t.mainHost).concat(i)}))}}))}catch(E){}if(B&&S){if("dimensions"===B.key&&S.indexOf("; ")>-1){var I=S.split("; ");!a.weight&&I[1]&&(a.weight=I[1]),S=I[0]}a[B.key]=S}}}}catch(N){x.e(N)}finally{x.f()}}}}catch(N){v.e(N)}finally{v.f()}}catch(W){}if(a.available_from){var P=b(new Date(a.available_from)),M=b(new Date),T=b.duration(M.diff(P));try{a.available_from_utc=new Date(a.available_from).toISOString(),a.available_for_months=Math.ceil(T.asMonths()),a.available_for_days=Math.ceil(T.asDays())}catch(L){}}return[a,r]}},{key:"extractProductVariants",value:function(e,t){var r=[],a=[],i=e("#variation_color_name > ul"),c="";i[0]||(i=e("#variation_style_name > ul")),i[0]||(i=e("#variation_size_name > ul"));try{var o=/jQuery.parseJSON\('([\w{}:;&,-.[\]\s+%\/()\/"|\\`']+)'\)/.exec(t);o&&(c=JSON.parse(o[1].replace(/\\'/g,"'")))}catch(k){}if(c){if(Object.keys(c.colorToAsin).length)for(var l in c.colorToAsin){var d=c.colorImages[l]||[],u={asin:c.colorToAsin[l].asin,images:d,title:l,link:"https://www.amazon.com/dp/".concat(c.colorToAsin[l].asin,"/?th=1&psc=1"),is_current_product:c.colorToAsin[l].asin===this.asin,price:""};try{var h=e('li[data-defaultasin="'.concat(c.colorToAsin[l].asin,'"] div.twisterSlotDiv')).text();h&&(u.price=h)}catch(b){}r.push(u)}a=c.videos}else try{var p,f=n(i[0].children);try{for(f.s();!(p=f.n()).done;){var m=p.value,v={asin:"",images:"",title:"",link:"",is_current_product:!1,price:""};if(m.attribs["data-defaultasin"]&&(v.asin=m.attribs["data-defaultasin"]),m.attribs["data-dp-url"]){var _=/dp\/(\w+)\//.exec(m.attribs["data-dp-url"]);_&&(v.asin=_[1])}try{var y=e("li[id=".concat(m.attribs["id"],"] div.twisterSlotDiv")).text();y&&(v.price=y),v.images=m.children[0].children[0].children[0].children[0].children[0].children[0].children[1].children[0].children[0].attribs.src}catch(g){}v.title=m.attribs["title"]?m.attribs["title"].split(this.geo.variants.split_text)[1]:"",r.push(s(s({},v),{},{images:v.images?["".concat(v.images.split("._")[0],"._AC_SY879_.jpg")]:[],link:"https://www.amazon.com/dp/".concat(v.asin,"/?th=1&psc=1"),is_current_product:v.asin===this.asin}))}}catch(w){f.e(w)}finally{f.f()}}catch(x){}return[r,a]}},{key:"extractAlsoBought",value:function(e){var t=[],r=e("#desktop-dp-sims_purchase-similarities-sims-feature > div > div.a-row.a-carousel-controls.a-carousel-row.a-carousel-has-buttons > div > div.a-carousel-col.a-carousel-center > div");if(!r[0])return t;try{if(!r[0].children[0].children)return t}catch(m){return t}var a,i=n(r[0].children[0].children);try{for(i.s();!(a=i.n()).done;){var s=a.value,c={asin:"",title:"",image:[],url:"",reviews:{total_reviews:0,rating:0},price:{symbol:this.geo.symbol,currency:this.geo.currency,current_price:0},badges:{amazon_prime:!1}};try{var o=JSON.parse(s.children[0].attribs["data-p13n-asin-metadata"]);c.asin=o.asin,c.url="https://www.amazon.com/dp/".concat(c.asin,"/?th=1&psc=1")}catch(v){}try{var l=s.children[0].children[0].children[0].children[0];l&&(c.title=l.attribs.alt,c.image=[l.attribs.src])}catch(_){}try{var d=e(s.children[0].children[1].children[1]).text();d&&(c.reviews.total_reviews=parseInt(d.replace(/[^\d]/g,""),10))}catch(y){}try{var u=s.children[0].children[1].children[0].children[0];if(u){var h=u.attribs.class;if(h.indexOf("a-star-")>-1){var p=h.split("a-star-")[1];c.reviews.rating=parseFloat(p.replace("-","."))}}}catch(k){}try{var f=e(s.children[0].children[2]).text();f&&(c.price.current_price=this.geo.price_format(f))}catch(b){}t.push(c)}}catch(g){i.e(g)}finally{i.f()}return t}},{key:"extractSponsoredProducts",value:function(e){var t=[],r=e("#sp_detail-none > div:nth-child(3) > div > div > div.a-carousel-col.a-carousel-center > div");if(!r[0])return t;try{if(!r[0].children[0].children)return t}catch(m){return t}var a,i=n(r[0].children[0].children);try{for(i.s();!(a=i.n()).done;){var s=a.value,c={asin:"",title:"",image:[],url:"",reviews:{total_reviews:0,rating:0},price:{symbol:this.geo.symbol,currency:this.geo.currency,current_price:0},badges:{amazon_prime:!1}};c.asin=s.children[1].attribs["data-asin"],c.url="https://www.amazon.com/dp/".concat(c.asin,"/?th=1&psc=1");try{var o=e("#sp_detail-none_".concat(c.asin," > a > img"));o[0]&&(c.title=o[0].attribs.alt,c.image=[o[0].attribs.src])}catch(v){}var l=e("#sp_detail-none_".concat(c.asin," > div:nth-child(6) > a > span")).text();l&&(c.reviews.total_reviews=parseInt(l.replace(/[^\d]/g,""),10));var d=e("#sp_detail-none_".concat(c.asin," > div.a-row.a-color-price > a:nth-child(1) > span")).text();d&&(c.price.current_price=this.geo.price_format(d));var u=e("#sp_detail-none_".concat(c.asin," > div.a-row.a-color-price > a:nth-child(2) > span > i"));u[0]&&u[0].attribs.class.indexOf("a-icon-prime")>-1&&(c.badges.amazon_prime=!0);var h=e("#sp_detail-none_".concat(c.asin," > div:nth-child(6) > a > i"));if(h[0]){var p=h[0].attribs.class;if(p.indexOf("a-star-")>-1){var f=p.split("a-star-")[1];c.reviews.rating=f.indexOf("-")>-1?f.replace("-","."):f}}t.push(c)}}catch(_){i.e(_)}finally{i.f()}return t}},{key:"grapAsinDetails",value:function(e){e=e.replace(/\s\s+/g,"").replace(/\n/g,"");var t=_.load(e),r={title:"",description:"",feature_bullets:[],variants:[],categories:[],asin:this.asin,url:"".concat(this.mainHost,"/dp/").concat(this.asin),reviews:{total_reviews:0,rating:0,answered_questions:0},item_available:!0,price:{symbol:this.geo.symbol,currency:this.geo.currency,current_price:0,discounted:!1,before_price:0,savings_amount:0,savings_percent:0},bestsellers_rank:[],main_image:"",total_images:0,images:[],total_videos:0,videos:[],delivery_message:"",product_information:{dimensions:"",weight:"",available_from:"",available_for_months:0,available_for_days:0,manufacturer:"",model_number:"",department:"",store_id:"",brand:"",sold_by:"",fulfilled_by:"",qty_per_order:"na"},badges:{"amazon_сhoice":!1,amazon_prime:!1},sponsored_products:[],also_bought:[],other_sellers:[]},n=this.extractBookInSeries(t);n.length&&(r.book_in_series=n),r.other_sellers=this.extractOtherSellers(t);var i=this.extractAuthors(t);i.length&&(r.authors=i),r.categories=this.extractProductCategories(t),r.item_available=!t("span.qa-availability-message").text(),r.sponsored_products=this.extractSponsoredProducts(t),r.also_bought=this.extractAlsoBought(t);var s=this.extractProductVariants(t,e),c=a(s,2);if(r.variants=c[0],r.videos=c[1],r.total_videos=r.videos.length,r.description=t("#productDescription").text(),e.indexOf("bookDescription_feature_div")>-1&&!r.description){r.description=t("#bookDescription_feature_div").text();try{r.description=t(r.description).text()||""}catch(m){}}r.feature_bullets=this.extractProductFeatures(t);var o=this.extractProductInfromation(t),l=a(o,2);r.product_information=l[0],r.bestsellers_rank=l[1];var d=t("#deliveryMessageMirId").text();r.delivery_message=d;var u=t('div[id="merchant-info"]').text();if(u)try{if(u.indexOf("Ships from and sold by ")>-1){var h=u.split("Ships from and sold by ")[1];r.product_information.sold_by=h.slice(0,-1),r.product_information.fulfilled_by=h.slice(0,-1)}else{var p=u.split("Sold by ")[1].split(" and ");r.product_information.sold_by=p[0],r.product_information.fulfilled_by=p[1].split("Fulfilled by ")[1].slice(0,-1)}}catch(v){}var f=t('select[id="quantity"]');if(f)try{r.product_information.qty_per_order=f[0]?f[0].children.length:"na"}catch(y){}if(r.title=t('span[id="productTitle"]').text()||t(".qa-title-text").text(),r.reviews.total_reviews=t('span[id="acrCustomerReviewText"]').text().split(/\s/)[0]?parseInt(t('span[id="acrCustomerReviewText"]').text().split(/\s/)[0].replace(/[^0-9]/g,""),10):0,r.reviews.answered_questions=t('a[id="askATFLink"]').text()?parseInt(t('a[id="askATFLink"]').text(),10):0,r.reviews.rating=t("span.reviewCountTextLinkedHistogram.noUnderline")[0]?t(t("span.reviewCountTextLinkedHistogram.noUnderline")[0]).text().split(/\s/g)[0]:0,r.price.current_price=t("#priceblock_ourprice")[0]?this.geo.price_format(t(t("#priceblock_ourprice")[0].children[0]).text()):0,!r.current_price)try{r.price.current_price=this.geo.price_format(t(t(".apexPriceToPay")[0].children[0]).text())}catch(k){}r.product_information.store_id=t('input[id="storeID"]').val(),r.product_information.brand=t('a[id="bylineInfo"]').text()||"",r.badges.amazon_сhoice=!!t("div.ac-badge-wrapper")[0],r.badges.amazon_prime=!!t('span[id="priceBadging_feature_div"]')[0],r.price.discounted=!!t("span.priceBlockStrikePriceString.a-text-strike")[0],r.price.before_price=r.price.discounted?this.geo.price_format(t("span.priceBlockStrikePriceString.a-text-strike").text()):r.price.current_price,r.price.discounted&&(r.price.savings_amount=+(r.price.before_price-r.price.current_price).toFixed(2),r.price.savings_percent=+(100/r.price.before_price*r.price.savings_amount).toFixed(2)),r.images=this.extractImages(t,e),r.main_image=r.images.length?r.images[0]:"",r.total_images=r.images.length,this.collector.push(r)}},{key:"grabProduct",value:function(e,t){for(var r=_.load(e.replace(/\s\s+/g,"").replace(/\n/g,"")),a=r("div[data-index]"),n={},i=0,s=0;s<a.length;s++){var c=a[s].attribs["data-asin"];c&&(n[c]={position:{page:t,position:i+=1,global_position:"".concat(t).concat(s)},asin:c,price:{discounted:!1,current_price:0,currency:this.geo.currency,before_price:0,savings_amount:0,savings_percent:0},reviews:{total_reviews:0,rating:0},url:"".concat(this.mainHost,"/dp/").concat(c),score:0,sponsored:!1,amazonChoice:!1,bestSeller:!1,amazonPrime:!1})}for(var o in n)try{var l=r("div[data-asin=".concat(o,'] span[data-a-size="l"]'))[0]||r("div[data-asin=".concat(o,'] span[data-a-size="m"]'))[0],d=r("div[data-asin=".concat(o,'] span[data-a-strike="true"]'))[0],u=r("div[data-asin=".concat(o,"] .a-icon-star-small"))[0],h=r("div[data-asin=".concat(o,'] [data-image-source-density="1"]'))[0],p=r("div[data-asin=".concat(o,'] span[id="').concat(o,'-amazons-choice"]')).text(),f=r("div[data-asin=".concat(o,'] span[id="').concat(o,'-best-seller"]')).text(),m=r("div[data-asin=".concat(o,"] .s-prime"))[0];if(l&&(n[o].price.current_price=this.geo.price_format(r(l.children[0]).text())),p&&(n[o].amazonChoice=!0),f&&(n[o].bestSeller=!0),m&&(n[o].amazonPrime=!0),d){n[o].price.before_price=this.geo.price_format(r(d.children[0]).text()),n[o].price.discounted=!0;var v=n[o].price.before_price-n[o].price.current_price;v<=0?(n[o].price.discounted=!1,n[o].price.before_price=0):(n[o].price.savings_amount=+(n[o].price.before_price-n[o].price.current_price).toFixed(2),n[o].price.savings_percent=+(100/n[o].price.before_price*n[o].price.savings_amount).toFixed(2))}u&&(n[o].reviews.rating=parseFloat(u.children[0].children[0].data),n[o].reviews.total_reviews=parseInt(u.parent.parent.parent.next.attribs["aria-label"].replace(/\,/g,"")),n[o].score=parseFloat(n[o].reviews.rating*n[o].reviews.total_reviews).toFixed(2)),h&&(n[o].title=h.attribs.alt,n[o].thumbnail=h.attribs.src)}catch(k){continue}for(var y in n)this.collector.push(n[y]);if(a.length<10)throw new Error("No more products")}},{key:"validateRating",value:function(e){return("products"===this.scrapeType&&e.reviews.rating>=this.minRating&&e.reviews.rating<=this.maxRating||"reviews"===this.scrapeType&&e.rating>=this.minRating&&e.rating<=this.maxRating)&&e}},{key:"extractProductCategories",value:function(e){var t=this,r=[],a=e("#wayfinding-breadcrumbs_feature_div > ul")[0];return a&&a.children&&a.children.forEach((function(e){try{if(!e.attribs.class){var a="".concat(t.mainHost).concat(e.children[0].children[0].attribs.href),n=e.children[0].children[0].children[0].data;r.push({category:n,url:a})}}catch(i){}})),r}},{key:"extractAuthors",value:function(e){var t=this,r=[],a=e("#bylineInfo")[0];return a&&a.children&&a.children.forEach((function(a,n){try{if(a&&"span"===a.name&&a.attribs.class.indexOf("author")>-1){var i="",s="",c=e("#bylineInfo > span:nth-child(".concat(n,") > span.contribution")).text();if(c&&(c=c.replace(/[(),\s]/g,"")),"a"===a.children[0].name){var o=e("#bylineInfo > span:nth-child(".concat(n,") > a"))[0].attribs.href;"#"!=o&&(i="".concat(t.mainHost).concat(o),s=e("#bylineInfo > span:nth-child(".concat(n,") > a")).text())}else{var l=e("#bylineInfo > span:nth-child(1) > span.a-declarative > a.a-link-normal.contributorNameID")[0].attribs.href;i="".concat(t.mainHost).concat(l),s=e("#bylineInfo > span:nth-child(1) > span.a-declarative > a.a-link-normal.contributorNameID").text()}s&&i&&r.push({author:s,role:c,url:i})}}catch(d){}})),r}},{key:"extractOtherSellers",value:function(e){var t=this,r=[],a=e("#mbc")[0],n=0;return a&&a.children&&a.children.forEach((function(a,i){try{if(a.attribs.class&&"a-box mbc-offer-row pa_mbc_on_amazon_offer"===a.attribs.class){n+=1;var s=e("#mbc > div:nth-child(".concat(i+1,") > div > span.a-declarative > div > div:nth-child(1)")).text(),c=e("#mbc-sold-by-".concat(n," > span.a-size-small.mbcMerchantName")).text(),o="".concat(t.mainHost).concat(e("#mbc-buybutton-addtocart-".concat(n,"-announce"))[0].attribs.href);r.push({position:n,seller:c,url:o,price:{symbol:t.geo.symbol,currency:t.geo.currency,current_price:t.geo.price_format(s)}})}}catch(l){}})),r}},{key:"extractImages",value:function(e,t){var r=[],a=/'colorImages': { 'initial': (.+)},'colorToAsin'/.exec(t);if(a)try{var n=JSON.parse(a[1]);r=n.map((function(e){return e.hiRes||e.large}))}catch(p){}if(!r.length){var i=e("#imgBlkFront")[0]||e("#ebooksImgBlkFront")[0];if(i){var s=i.attribs["data-a-dynamic-image"],c=JSON.parse(s),o=Object.keys(c),l=/\/([\w-+]{9,13})\./.exec(o[0]);l&&r.push("https://images-na.ssl-images-amazon.com/images/I/".concat(l[1],".jpg"))}}if(!r.length)for(var d=e('span[data-action="thumb-action"]'),u=0;u<d.length;u++)try{var h=d[u].children[0].children[0].children[1].children[0].attribs.src;-1===h.indexOf("x-locale/common")&&r.push("".concat(h.split("._")[0],"._AC_SY879_.jpg"))}catch(f){}return r}},{key:"extractBookInSeries",value:function(e){var t=this,r=[],a=e("div.shoveler-cell:nth-child(2)")[0];if(a)try{var n=e("div.shoveler-cell:nth-child(2) > a:nth-child(1)")[0].attribs.href,i=e("img.product-image:nth-child(1)")[0].attribs.src,s=e("div.shoveler-cell:nth-child(2) > a:nth-child(2)").text();r.push({series_name:s.trim(),images:[i],url:"".concat(this.mainHost).concat(n)})}catch(o){}var c=e("div.a-carousel-controls:nth-child(3) > div:nth-child(1) > div:nth-child(2) > div:nth-child(1) > ol:nth-child(1)")[0];return c&&c.children&&c.children.forEach((function(a,n){try{n+=1;var i={total_reviews:0,rating:0},s={symbol:t.geo.symbol,currency:t.geo.currency,current_price:0},c=e("div.a-carousel-controls:nth-child(3) > div:nth-child(1) > div:nth-child(2) > div:nth-child(1) > ol:nth-child(1) > li:nth-child(".concat(n,") > div:nth-child(1) > a:nth-child(1) > div:nth-child(1) > span:nth-child(1)")).text(),o=e("div.a-carousel-controls:nth-child(3) > div:nth-child(1) > div:nth-child(2) > div:nth-child(1) > ol:nth-child(1) > li:nth-child(".concat(n,") > div:nth-child(1) > a:nth-child(1) > div:nth-child(1) > img:nth-child(2)"))[0].attribs.src,l=e("div.a-carousel-controls:nth-child(3) > div:nth-child(1) > div:nth-child(2) > div:nth-child(1) > ol:nth-child(1) > li:nth-child(".concat(n,") > div:nth-child(1) > a:nth-child(1)"))[0].attribs.href,d=e("div.a-carousel-controls:nth-child(3) > div:nth-child(1) > div:nth-child(2) > div:nth-child(1) > ol:nth-child(1) > li:nth-child(".concat(n,") > div:nth-child(1) > a:nth-child(2) > span:nth-child(1)")).text(),u=e("div.a-carousel-controls:nth-child(3) > div:nth-child(1) > div:nth-child(2) > div:nth-child(1) > ol:nth-child(1) > li:nth-child(".concat(n,") > div:nth-child(1) > div:nth-child(3) > div:nth-child(1) > span:nth-child(1) > a:nth-child(1) > span:nth-child(2)")).text(),h=e("div.a-carousel-controls:nth-child(3) > div:nth-child(1) > div:nth-child(2) > div:nth-child(1) > ol:nth-child(1) > li:nth-child(".concat(n,") > div:nth-child(1) > div:nth-child(3) > div:nth-child(1) > span:nth-child(1) > a:nth-child(1) > i:nth-child(1) > span:nth-child(1)"))[0]?e(e("div.a-carousel-controls:nth-child(3) > div:nth-child(1) > div:nth-child(2) > div:nth-child(1) > ol:nth-child(1) > li:nth-child(".concat(n,") > div:nth-child(1) > div:nth-child(3) > div:nth-child(1) > span:nth-child(1) > a:nth-child(1) > i:nth-child(1) > span:nth-child(1)"))[0]).text().split(/\s/g)[0]:0;i.total_reviews=parseInt(u.replace(/[^\d]/g,""),10),i.rating=h;var p=e("div.a-carousel-controls:nth-child(3) > div:nth-child(1) > div:nth-child(2) > div:nth-child(1) > ol:nth-child(1) > li:nth-child(".concat(n,") > div:nth-child(1) > div:nth-child(5)")).text();s.current_price=t.geo.price_format(p),r.push({serie:c,title:d,images:[o],url:"".concat(t.mainHost).concat(l),reviews:i,price:s})}catch(f){}})),r}},{key:"extractCategories",value:function(){var e=c(regeneratorRuntime.mark((function e(){var t,r,a,i,s,c,o,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.buildRequest();case 2:if(t=e.sent,r=_.load(t.replace(/\s\s+/g,"").replace(/\n/g,"")),a=r("#searchDropdownBox")[0],Array.isArray(a.children)){e.next=7;break}throw new Error("Can't find category selector");case 7:i={},s=n(a.children);try{for(s.s();!(c=s.n()).done;)o=c.value,l=o.attribs.value.split("search-alias=")[1],i[l]={name:o.children[0].data,category:l}}catch(d){s.e(d)}finally{s.f()}return e.abrupt("return",i);case 11:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),e}();e.exports=w}});
//# sourceMappingURL=app.1dbf9d6f.js.map